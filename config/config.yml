%YAML 1.2
---
imports:
  - resource: secret_parameters.yml
  - resource: ../package.json
    pick:
        name: app.name
        version: app.version

parameters:
  ISTEX_JOBS_USE_CACHE_LOOKUP: true
  ISTEX_JOBS_ISTEX_API_URL: https://api.istex.fr
  ISTEX_JOBS_REVIEW_URL: https://revue-sommaire.data.istex.fr
  ISTEX_JOBS_API_HOST: 0.0.0.0
  ISTEX_JOBS_API_PORT: 8080
  ISTEX_JOBS_LOG_PATH: /var/log
  ISTEX_JOBS_REVERSE_PROXY: false

app:
  sid: istex-jobs
  useEthereal: false
  configPath: ./config.json
  doExitOnUnhandledRejection: true

security:
  reverseProxy: %env(ISTEX_JOBS_REVERSE_PROXY)%

istex:
  api:
    url: %env(ISTEX_JOBS_ISTEX_API_URL)%

    # Boolean This should stay disabled when making requests to internal hostnames, @see https://www.npmjs.com/package/got#dnscache
    useCacheLookup: %env(ISTEX_JOBS_USE_CACHE_LOOKUP)%

    # timeout may be Object or Number, @see https://www.npmjs.com/package/got#timeout
    timeout:
     response: 10000 # ms

  review:
    url: %env(ISTEX_JOBS_REVIEW_URL)%
    # timeout may be Object or Number, @see https://www.npmjs.com/package/got#timeout
    timeout:
     response: 5000 # ms

exchange:
    outputPath: ./output/exchange

nodeMailer:
   transports:
        main:
            host: %env(ISTEX_JOBS_MAILER_HOST)%
            port: %env(ISTEX_JOBS_MAILER_PORT)%
   onErrorTo: %env(ISTEX_JOBS_MAILER_TO)%


log:
  path: %env(ISTEX_JOBS_LOG_PATH)%

express:
  api:
    host: %env(ISTEX_JOBS_API_HOST)%
    port: %env(ISTEX_JOBS_API_PORT)%
  allowedAccessMethods:
    - GET
    - OPTIONS

nodejs:
  stackTraceLimit: 40
